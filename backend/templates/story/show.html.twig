{% extends 'base.html.twig' %}

{% block title %}{{ story.title }}{% endblock %}

{% block body %}
    <article style="max-width: 800px; margin: 0 auto; padding: 1rem;">
        <h1>{{ story.title }}</h1>
        <p>
            Par {{ story.user ? story.user.displayName : 'Anonyme' }} ·
            {{ story.createdAt ? story.createdAt|date('d/m/Y') : '' }}
            {% if story.status == 'draft' %}<span>(Brouillon)</span>{% endif %}
        </p>
        <div>
            {{ story.content|e('html')|nl2br }}
        </div>
    </article>

    <p style="max-width: 800px; margin: 0 auto; padding: 0 1rem;">
        <strong>Likes:</strong> {{ story.likesCount }}
        {% if app.user %}
            <form action="{{ path('app_story_like', { id: story.id }) }}" method="post" style="display:inline">
                <input type="hidden" name="_token" value="{{ csrf_token('like' ~ story.id) }}" />
                <button type="submit">J'aime / Je n'aime plus</button>
            </form>
        {% endif %}
    </p>

    <p style="max-width: 800px; margin: 0 auto; padding: 0 1rem;">
        <a href="{{ path('app_story_index') }}">← Retour à la liste</a>
        {% if app.user and app.user == story.user %}
            · <a href="{{ path('app_story_edit', {'id': story.id}) }}">Modifier</a>
            · {{ include('story/_delete_form.html.twig') }}
        {% endif %}
    </p>
{% endblock %}
